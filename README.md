# xTurnover: Expected Turnover Model for Football Pass Analysis

A complete machine learning pipeline that predicts the probability of
turnovers in football passes using mixed-effects logistic regression
with cross-validation. This implementation is based on the methodology
published in the *Journal of Sports Sciences* and provides an automated
system for calculating Expected Turnover (xTurnover) metrics in football
analytics.

## ‚ö†Ô∏è Important Data Requirements

**Before using this model, you must ensure your dataset contains all
required variables.** Some features require preprocessing from
positional tracking data and cannot be generated by this modeling
pipeline alone.

### Required Preprocessing Steps

1.  **Positional Feature Generation**: Several key variables must be
    pre-computed from player tracking data\
2.  **Data Structure Compliance**: Your dataset must contain all
    variables listed in the "Model Inputs" section\
3.  **Variable Naming**: Column names must match exactly as specified

**This model assumes you have already processed your raw data to include
all required features.**

## üìñ Academic Background

This project implements the xTurnover model described in:

**"Predicting turnovers in football using spatial and contextual data:
An expected turnover model"**\
*Journal of Sports Sciences*, 2024\
DOI: 10.1080/02640414.2024.2379697

### Research Context

The xTurnover model addresses a critical gap in football analytics by
quantifying pass risk beyond traditional accuracy metrics. While
conventional statistics measure whether a pass was completed, xTurnover
evaluates the *likelihood* of completion given the situational context,
providing insights into player decision-making under pressure.

## üéØ Overview

This project analyzes football passing data to predict turnover
probability based on various contextual factors including ball position,
movement patterns, pressing intensity, and available passing options.
The model uses hierarchical modeling to account for player, match, and
position-specific effects, with a complete automation pipeline for
production use.

### Key Research Findings

-   Robust predictive performance across multiple validation approaches\
-   Spatial features were highly predictive of turnover risk\
-   Pressing intensity significantly influenced pass completion
    probability\
-   Player random effects captured individual decision-making patterns\
-   xTurnover metric provided actionable tactical insights

## ‚ú® Key Features

-   Peer-reviewed methodology\
-   Stratified 5-fold cross-validation\
-   Mixed-effects logistic regression\
-   Full performance metric suite\
-   Risk categorization\
-   Automation-ready pipeline\
-   Timestamped outputs\
-   Error handling

## üìä Model Inputs

**CRITICAL**: All variables listed below must be present in your dataset
before running the model.

### Basic Event Data

-   `turnover_count`\
-   `player.name`\
-   `match_id`\
-   `position_group`

### Spatial Features

-   `x`, `y`\
-   `distance_ball_moved`\
-   `ball_movement_speed`\
-   `percent_distance`\
-   `pass.angle`

### Contextual Features

-   `play_pattern.name`\
-   `pass.type.name`

### Pressing Features (from positional data)

-   `pressing_count_1`\
-   `pressing_count_2`\
-   `pressing_count_3`

### Teammate Orientation Features (from positional data)

-   `right_option`, `front_option`, `left_option`, `back_option`

## üîß Data Preprocessing Requirements

### Step 1: Positional Data Processing

-   Calculate pressing variables ( radii)\
-   Calculate orientation variables (directional quadrant availability)

### Step 2: Data Validation

R required columns check:

    required_columns <- c(
      "turnover_count", "x", "y", "distance_ball_moved", "ball_movement_speed",
      "percent_distance", "pass.angle", "pressing_count_1", "pressing_count_2", 
      "pressing_count_3", "play_pattern.name", "pass.type.name",
      "right_option", "front_option", "left_option", "back_option",
      "player.name", "match_id", "position_group"
    )

## üöÄ Quick Start

### Prerequisites

    install.packages(c("lme4", "dplyr", "pROC"))

### Command Line Execution

    chmod +x run_turnover_model.sh
    ./run_turnover_model.sh your_prepared_data.csv

### R Interactive Usage

    source("cross_validate_turnover_model.R")
    data <- read.csv("your_prepared_data.csv")
    cv_results <- cross_validate_turnover_model(
      data = data,
      outcome_var = "turnover_count",
      k_folds = 5,
      seed = 123,
      verbose = TRUE
    )


## üö® Common Issues and Solutions

-   Missing pressing variables ‚Üí compute using positional data\
-   Missing orientation variables ‚Üí compute using positional data\
-   Convergence errors ‚Üí check variable types, missingness, sample size

## üìä Generated Outputs

-   `dataset_with_xTurnover.csv`\
-   `model_summary_statistics.csv`\
-   `fold_details.csv`\
-   `confusion_matrix.csv`\
-   `all_predictions.csv`\
-   `model_report.txt`\
-   `complete_cv_results.rds`

# üéÆ Research Applications

Based on findings from the published study, the xTurnover model enables
a broad range of analytical and academic uses.

------------------------------------------------------------------------

## üìà Performance Analysis

### **Player Evaluation**

Quantify decision-making quality beyond simple completion rates.

### **Risk Assessment**

Identify when players attempt difficult passes successfully or
unsuccessfully.

### **Contextual Analysis**

Evaluate how pressure and defensive behavior affect pass selection.

------------------------------------------------------------------------

## üß† Tactical Applications

### **Opposition Analysis**

Identify high-pressure situations created by defensive structures.

### **Match Strategy**

Isolate scenarios that produce high xTurnover values for targeted
pressing strategies

------------------------------------------------------------------------

## üéì Academic Research

### **Reproducible Results**

Standardised methodology suitable for cross-study comparisons.

### **Feature Analysis**

Study which contextual factors most heavily influence turnover
probability.

### **Model Extensions**

Use the implementation as a foundation for advanced football analytics
research.

------------------------------------------------------------------------

# üîç Example Research Workflow

## 1. **Data Preparation**

Ensure your dataset meets the paper's specifications and includes all
required preprocessing (pressing, orientation, spatial features).

------------------------------------------------------------------------

## 2. **Model Execution**

``` bash
./run_turnover_model.sh premier_league_data.csv
```

------------------------------------------------------------------------

## 3. **Results Analysis**

-   Review `model_report.txt` for performance summary\
-   Analyze `dataset_with_xTurnover.csv` for insights\
-   Use statistical tests to validate empirical findings

------------------------------------------------------------------------

## 4. **Research Extension (R Example)**

``` r
# Load results for further analysis
results <- readRDS("complete_cv_results.rds")

# Analyze player-specific patterns
player_analysis <- results$xTurnover_dataset %>%
  group_by(player.name) %>%
  summarise(
    avg_xTurnover = mean(xTurnover, na.rm = TRUE),
    actual_turnover_rate = mean(turnover_count),
    decision_quality = actual_turnover_rate - avg_xTurnover
  )
```

------------------------------------------------------------------------

# üìã Data Requirements

## **Academic Standards**

-   **Minimum Sample Size:** Typically \>1000 observations for stable
    mixed-effects modeling\
-   **Temporal Coverage:** Multiple matches to support random effects
    estimates\
-   **Spatial Accuracy:** High-quality coordinate data required for
    spatial/pressing features

## **File Formats**

-   **CSV** ‚Üí event + contextual data\
-   **RDS** ‚Üí reproducible model outputs

------------------------------------------------------------------------

# üî¨ Validation and Reproducibility

## **Cross-Validation Protocol**

-   **Stratified Sampling:** Preserves turnover proportions\
-   **No Temporal Leakage:** Ensures future events never influence past
    folds\
-   **Stability Checks:** Consistent performance across folds

## **Reproducibility Features**

-   Fixed random seeds\
-   Version-controlled scripts\
-   Fully documented workflow

------------------------------------------------------------------------

# üîß Customization

## **Model Parameters**

Modify `turnover_cv_analysis.R` to adjust:

-   Number of folds (`k_folds`)\
-   Optimizer selection (`optimizer`)\
-   Maximum iterations (`max_iterations`)\
-   Random seed (`seed`)

## **Output Options**

You may edit the script to change:

-   Output filenames\
-   Additional summary statistics\
-   Custom plots or visualizations

------------------------------------------------------------------------

# üö® Error Handling

The pipeline includes robust safeguards:

-   **Data validation:** Required column checks\
-   **File checks:** Ensures input files exist\
-   **Model convergence warnings**\
-   **Output verification**

------------------------------------------------------------------------

# üìö Citation

### **If using the methodology, cite:**

    @article{xTurnover2024,
      title={Predicting turnovers in football using spatial and contextual data: An expected turnover model},
      author={[Author Names]},
      journal={Journal of Sports Sciences},
      year={2024},
      doi={10.1080/02640414.2024.2379697},
      url={https://www.tandfonline.com/doi/epdf/10.1080/02640414.2024.2379697}
    }

### **If using the software implementation, cite:**

    @software{xTurnover_implementation,
      title={xTurnover: Expected Turnover Model Implementation},
      author={[Your Name]},
      year={2024},
      url={https://github.com/[your-repo]},
      note={Implementation of methodology from Journal of Sports Sciences}
    }

------------------------------------------------------------------------

# ü§ù Academic Collaboration

We welcome extensions, replications, and methodological improvements.

## **Research Opportunities**

-   Multi-league validation\
-   Advanced feature engineering\
-   Real-time model application\
-   Integration with other football metrics

## **Contribution Guidelines**

-   Maintain scientific rigor\
-   Document methodology changes thoroughly\
-   Validate against independent datasets\
-   Follow reproducible research practices

------------------------------------------------------------------------

# ü§ù Contributing

1.  Fork the repository\

2.  Create a feature branch:

    ``` bash
    git checkout -b feature/AmazingFeature
    ```

3.  Test your changes with sample data\

4.  Commit:

    ``` bash
    git commit -m "Add some AmazingFeature"
    ```

5.  Push:

    ``` bash
    git push origin feature/AmazingFeature
    ```

6.  Open a Pull Request

------------------------------------------------------------------------

# üìÑ License

This project is distributed under the **MIT License**. See `LICENSE` for
details.

------------------------------------------------------------------------

# üìß Contact

### **Academic Inquiries**

-   Open an issue for methodology questions\
-   Contact maintainers for collaboration proposals\
-   Follow open science principles for data sharing

### **Technical Support**

-   Check `model_report.txt` for detailed model diagnostics\
-   Ensure all required variables are present in your dataset\
-   Open an issue with sample data + error logs

------------------------------------------------------------------------

# üèÜ Acknowledgments

This implementation builds upon peer-reviewed research published in the
*Journal of Sports Sciences*.\
We acknowledge the authors, reviewers, and editorial team for advancing
football analytics research.

**Research Note:**\
Model performance may vary across leagues, seasons, and
contexts---validate on your own dataset.

**Implementation Note:**\
Pressing and orientation variables **must** be derived from positional
tracking data; they cannot be computed from event data alone.
